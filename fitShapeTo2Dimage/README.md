# 2次元顕微鏡画像に対し、3次元SE形状を照らし合わせる
2次元顕微鏡画像での観察実験によって、ベシクルの変形を観察した時、これが3次元的にどのように面積・体積変化をしているのかということが知りたくなることは多い。
先に言っておくと、当然だが3次元形状の射影である2次元顕微鏡画像の情報では元の形状を正確に推定するのは不可能である。
しかし、いくつかの仮定と、きれいな実験結果があれば、**もっともらしい**3次元形状の推定はできると考えられる。
それでも、この方法で得られた3次元形状はあくまで推定に過ぎず、それだけでは十分信頼できるものとは言えないので、この方法で面積・体積変化を推定するならば、
面積・体積変化のダイナミクスのモデルを別に考えて、結果をサポートすることが必要とされるだろう。

## 方法
一言で言えば、「実験データと似た形状データを、データベースから探す」ということだが、なるべく定量性を上げるために幾つかの特徴的な長さを実験データと形状データのそれぞれで測定し、それらの比率から最も合う形状を探し出す。  
特徴的な長さ、とは楕円の長軸と短軸の比であったり、pear型であれば、2つのヘッド部分の半径と、ネック部分の半径である。  
これらの値の比を実際の実験結果と比較し、誤差10％以内程度で一致する形状を探す。

![fig1.png](/fitShapeTo2Dimage/fig1.png)

## 推定した3次元形状から、実際の物理量を求める
ターミナルから
evolver 〇〇.dmp　で形状ファイルを読み込みます。
その後コマンド `v`で以下のように基本的な物理量が表示されます。
```
Enter command: v
Body          target volume           actual volume          pressure
  1      0.0648857777974809      0.0648857777974699 -26.3990034261863

            Quantity       target value           actual value                 pressure
             benergy         ---------            1.69393520756471
               farea                       1       0.999999999999934   3.35559714777911
                 mci        3.72215416090528        3.72215416090518  0.101199451029443
              offset         ---------          -0.999999999999934
```

actual volumeが現在の体積
farea の actual valueが現在の面積になっています（今回のファイルでは規格化されているので、ほぼ1）。

次に、コマンド`s`を打つと、別ウィンドウで3次元形状が表示されますが、
この画面のvertexを右クリックすることで、vertexのインデックスがターミナル上に次のように表示されます。
```
Picked vertex 396
Picked edge 1661
```

この頂点のインデックスから`list vertex[〇〇]`で、次のように3次元座標を表示します
```
Enter command: list vertex[396]        
// Id               X                Y               Z
396  0.174811886589951 -0.187917215517139 -0.45000737703622
```

これによって、SE上の2点間の距離l_SEが測れます。

実際の顕微鏡データでも対応する距離l_realを測ることで、実際とSEとの距離の比 r = l_real / l_SEが計算できます。
この比を用いて、体積であれば r^3 、面積であれば r^2 を先ほど調べたactual volumeとactual fareaに掛けることで、フィットさせた3次元SE画像から、体積と面積を計算しています。


